import os
import sys
import base64
import tempfile
from tkinter import Tk, Button, Label
from PIL import Image, ImageTk
from io import BytesIO

# --- 埋め込んだBase64画像（※それぞれの .txt ファイルの中身を貼る） ---
ICON_BASE64 = b"""
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
"""

LOGO_BASE64 = b"""
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
"""

# --- ドキュメントフォルダの言語切り替えファイル処理 ---
documents_path = os.path.expanduser("~/Documents")
japanese_file = os.path.join(documents_path, "ae_force_japanese.txt")
english_file = os.path.join(documents_path, "ae_force_english.txt")

def set_japanese():
    if not os.path.exists(japanese_file):
        open(japanese_file, 'w').close()
    if os.path.exists(english_file):
        os.remove(english_file)
        open(japanese_file, 'w').close()
    root.destroy()

def set_english():
    if not os.path.exists(english_file):
        open(english_file, 'w').close()
    if os.path.exists(japanese_file):
        os.remove(japanese_file)
        open(english_file, 'w').close()
    root.destroy()

# --- アイコンとロゴ処理 ---
def set_window_icon(window):
    tmp_icon = tempfile.NamedTemporaryFile(delete=False, suffix=".ico")
    tmp_icon.write(base64.b64decode(ICON_BASE64))
    tmp_icon.close()
    window.iconbitmap(tmp_icon.name)

def get_logo_image():
    img_data = base64.b64decode(LOGO_BASE64)
    img = Image.open(BytesIO(img_data))
    img = img.resize((33, 33), Image.Resampling.LANCZOS)
    return ImageTk.PhotoImage(img)

# --- ウィンドウ作成とUI配置 ---
root = Tk()
root.title("AELC")
root.geometry("300x200")
root.configure(bg='#1f1f1f')
root.minsize(300, 200)

set_window_icon(root)
logo_img = get_logo_image()

logo_label = Label(root, image=logo_img, bg='#1f1f1f')
root.update_idletasks()

def place_logo():
    logo_label.place(x=root.winfo_width() - 33, y=root.winfo_height() - 33)

place_logo()
root.bind('<Configure>', lambda event: place_logo())

button_style = {
    "bg": "#1f1f1f", "fg": "#EBEBEB",
    "width": 20, "height": 2,
    "relief": "flat",
    "highlightthickness": 2,
    "highlightbackground": "#EBEBEB",
    "highlightcolor": "#EBEBEB"
}

Button(root, text="Japanese", command=set_japanese, **button_style).place(relx=0.5, rely=0.4, anchor='center')
Button(root, text="English", command=set_english, **button_style).place(relx=0.5, rely=0.6, anchor='center')

root.mainloop()
